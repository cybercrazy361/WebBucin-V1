<!DOCTYPE html>
<html lang="id" class="no-js">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Haiii Selamat Pagi Laura</title>
    <meta name="description" content="Semangat ya buat segala aktifitasnya" />
    <meta name="author" content="Wafa Rifki Anafin" />
    <link rel="stylesheet" type="text/css" href="css/uwu-primary.css" />
    <link rel="stylesheet" type="text/css" href="css/uwu.css" />
    <!-- Google Fonts (opsional, untuk aksen) -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        #firework-canvas {
            position: fixed;
            left: 0; top: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 99999;
        }
    </style>
    <script>
        document.documentElement.className="js";
        var supportsCssVars=function(){
            var e,t=document.createElement("style");
            return t.innerHTML="root: { --tmp-var: bold; }",
                document.head.appendChild(t),
                e=!!(window.CSS&&window.CSS.supports&&window.CSS.supports("font-weight","var(--tmp-var)")),
                t.parentNode.removeChild(t),e
        };
        supportsCssVars()||alert("Please view this website in a modern browser that supports CSS Variables.");
    </script>
</head>
<body id="xixixi">
    <!-- Canvas Kembang Api -->
    <canvas id="firework-canvas"></canvas>
    <main>
        <svg class="hidden">
            <symbol id="icon-soundon" viewBox="0 0 32 31">
                <title>Sound on</title>
                <path d="M6.405 9.239H0v13.128h6.405l12.474 8.316V.923L6.405 9.239zM5.75 20.491H1.875v-9.377h3.876v9.377zm11.252 6.687l-9.376-6.25v-10.25l9.376-6.25v22.75zm10.884-21.32c5.484 5.483 5.484 14.406 0 19.89l-1.326-1.326c4.753-4.752 4.753-12.486 0-17.239l1.326-1.326zm-2.652 2.651c4.021 4.022 4.021 10.566 0 14.587l-1.326-1.326c3.29-3.29 3.29-8.644 0-11.935l1.326-1.326zm-2.652 2.652a6.571 6.571 0 010 9.283l-1.327-1.326a4.694 4.694 0 000-6.63l1.327-1.327z"/>
            </symbol>
            <symbol id="icon-soundoff" viewBox="0 0 32 31">
                <title>Sound off</title>
                <path d="M6.409 9.11H0v13.135h6.409l12.48 8.32V.79L6.41 9.109zm-.655 11.258H1.876v-9.382h3.878v9.382zm11.26 6.691L7.63 20.804V10.55l9.382-6.255V27.06zM32 11.65l-1.327-1.326-4.027 4.027-4.028-4.027-1.327 1.326 4.028 4.028-4.028 4.028 1.327 1.327 4.027-4.028 4.028 4.028L32 19.705l-4.028-4.028L32 11.65z"/>
            </symbol>
        </svg>
        <div class="frame">
            <h1 class="frame__title"></h1>
            <div class="frame__links"></div>
            <div class="frame__demos">
                <a href="#" class="frame__demo frame__demo--current"></a>
            </div>
            <button class="toggle toggle--on button" id="toggle-btn" style="display: none;">
                <svg class="toggle__icon toggle__icon--on">
                    <use xlink:href="#icon-soundon"></use>
                </svg>
                <svg class="toggle__icon toggle__icon--off">
                    <use xlink:href="#icon-soundoff"></use>
                </svg>
            </button>
        </div>
        <div class="content">
            <br><br><br><br><br><br><br><br>
            <h3 class="content__subtitle">Selamat Pagi Laura</h3>
            <h2 class="content__title">LAURA NAVISAH NURHAMID</h2>
            <div class="content__credits">
                <span class="credits-bold">HAI LAURA</span>, ADA CERITA YANG TERBUAT KARENA JARAK.
                <span class="credits-pink">WKWKW CUMA SEKEDAR HIBURAN</span>.
                BURUNG GELATIK LAGI GOSOK GIGI.
                <span class="credits-highlight">SELAMAT PAGI CANTIK</span>.
                TETAP SEMANGAT <span class="credits-orange">SEMANGAT BERAKTIFITAS</span>
                <br>
                <span class="credits-author">CREATED BY PAKAR</span>
            </div>
        </div>
        <div class="screen screen--grid intro">
            <p class="intro__content">
                <span class="intro__content-line">Pakartiko</span>
                <span class="intro__content-line intro__content-line--small">Mempersembahkan</span>
            </p>
            <p class="intro__content">
                <span class="intro__content-line intro__content-line--small">Website Spesial Dibuat Limited Edition Untuk</span>
                <span class="intro__content-line">Laura Navisah Nurhamid</span>
            </p>
        </div>
        <div class="screen screen--flex action">
            <span class="action__line">Hai Laura</span>
            <button id="play-btn" class="button button--box" onclick="openFullscreen(); showFireworks();">Mulai Sekarang</button>
        </div>
    </main>
    <div id="p5_loading" class="p5_loading">
        <div class="p5_loading__inner"></div>
    </div>
    <!-- Libs p5js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/addons/p5.dom.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.8.0/addons/p5.sound.min.js"></script>
    <!-- Main visualizer + audio -->
    <script src="js/uwu.js"></script>
    <script>
        // Fullscreen
        var uwu = document.getElementById("xixixi");
        function openFullscreen() {
            if (uwu.requestFullscreen) {
                    uwu.requestFullscreen();
                } else if (uwu.webkitRequestFullscreen) { /* Safari */
                    uwu.webkitRequestFullscreen();
                } else if (uwu.msRequestFullscreen) { /* IE11 */
                    uwu.msRequestFullscreen();
                }
        }
        // Efek kembang api
        const fwCanvas = document.getElementById('firework-canvas');
        const fwCtx = fwCanvas.getContext('2d');
        let fireworks = [], particles = [];
        let fireworkTimer = null;
        let fireworkLoopInterval = null; // <<--- tambahkan untuk interval

        function randomColor() {
            const colors = [
                "#ff6ec4", "#ffd740", "#18eaff", "#f44336",
                "#8bc34a", "#7759f5", "#fd3a69", "#fff", "#d500f9"
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function resizeFireworkCanvas() {
            fwCanvas.width = window.innerWidth;
            fwCanvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeFireworkCanvas);
        resizeFireworkCanvas();

        function Firework(sx, sy, tx, ty) {
            this.x = sx;
            this.y = sy;
            this.sx = sx;
            this.sy = sy;
            this.tx = tx;
            this.ty = ty;
            this.distanceToTarget = Math.sqrt((tx - sx) ** 2 + (ty - sy) ** 2);
            this.distanceTraveled = 0;
            this.coordinates = [];
            this.coordinateCount = 3;
            while (this.coordinateCount--) {
                this.coordinates.push([this.x, this.y]);
            }
            this.angle = Math.atan2(ty - sy, tx - sx);
            this.speed = 4 + Math.random() * 2;
            this.acceleration = 1.02;
            this.brightness = Math.random() * 30 + 50;
            this.targetRadius = 2;
            this.color = randomColor();
        }
        Firework.prototype.update = function(index) {
            this.coordinates.pop();
            this.coordinates.unshift([this.x, this.y]);
            let vx = Math.cos(this.angle) * this.speed;
            let vy = Math.sin(this.angle) * this.speed;
            this.x += vx;
            this.y += vy;
            this.speed *= this.acceleration;
            this.distanceTraveled = Math.sqrt((this.x - this.sx) ** 2 + (this.y - this.sy) ** 2);
            if (this.distanceTraveled >= this.distanceToTarget) {
                createParticles(this.tx, this.ty, this.color);
                fireworks.splice(index, 1);
            }
        };
        Firework.prototype.draw = function() {
            fwCtx.beginPath();
            let lastCoord = this.coordinates[this.coordinates.length - 1];
            fwCtx.moveTo(lastCoord[0], lastCoord[1]);
            fwCtx.lineTo(this.x, this.y);
            fwCtx.strokeStyle = this.color;
            fwCtx.stroke();
            fwCtx.beginPath();
            fwCtx.arc(this.tx, this.ty, this.targetRadius, 0, Math.PI * 2);
            fwCtx.stroke();
        };

        function Particle(x, y, color) {
            this.x = x;
            this.y = y;
            this.angle = Math.random() * 2 * Math.PI;
            this.speed = Math.random() * 5 + 2;
            this.friction = 0.95;
            this.gravity = 0.018;
            this.hue = Math.random() * 60 + 30;
            this.brightness = Math.random() * 40 + 60;
            this.alpha = 1;
            this.decay = Math.random() * 0.012 + 0.011;
            this.color = color;
        }
        Particle.prototype.update = function(index) {
            this.speed *= this.friction;
            this.x += Math.cos(this.angle) * this.speed;
            this.y += Math.sin(this.angle) * this.speed + this.gravity;
            this.alpha -= this.decay;
            if (this.alpha <= 0.05) {
                particles.splice(index, 1);
            }
        };
        Particle.prototype.draw = function() {
            fwCtx.save();
            fwCtx.globalAlpha = this.alpha;
            fwCtx.beginPath();
            fwCtx.arc(this.x, this.y, 2.4, 0, Math.PI * 2);
            fwCtx.fillStyle = this.color;
            fwCtx.shadowColor = this.color;
            fwCtx.shadowBlur = 18;
            fwCtx.fill();
            fwCtx.restore();
        };

        function createParticles(x, y, color) {
            let count = 30 + Math.floor(Math.random() * 20);
            for (let i = 0; i < count; i++) {
                particles.push(new Particle(x, y, color));
            }
        }

        function loopFirework() {
            fwCtx.globalCompositeOperation = 'destination-out';
            fwCtx.fillStyle = 'rgba(0,0,0,0.17)';
            fwCtx.fillRect(0, 0, fwCanvas.width, fwCanvas.height);
            fwCtx.globalCompositeOperation = 'lighter';

            for (let i = fireworks.length - 1; i >= 0; i--) {
                fireworks[i].draw();
                fireworks[i].update(i);
            }
            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].draw();
                particles[i].update(i);
            }
            fireworkTimer = requestAnimationFrame(loopFirework);
        }

        // -- UPDATE: Kembang api berjalan terus-menerus --
        function showFireworks() {
            resizeFireworkCanvas();
            if (!fireworkTimer) loopFirework();

            // Jika sebelumnya sudah jalan, hapus intervalnya biar tidak dobel
            if (fireworkLoopInterval) clearInterval(fireworkLoopInterval);

            // Loop: tiap 800ms, munculkan kembang api baru
            fireworkLoopInterval = setInterval(() => {
                let w = fwCanvas.width, h = fwCanvas.height;
                let fx = Math.random() * w * 0.6 + w * 0.2;
                let fy = Math.random() * h * 0.3 + h * 0.2;
                fireworks.push(new Firework(w / 2, h, fx, fy));
            }, 800);

            // Hentikan otomatis setelah 12 detik (atau bebas)
            setTimeout(stopFireworks, 12000);
        }

        // Fungsi untuk stop & bersihkan canvas (auto panggil di atas)
        function stopFireworks() {
            if (fireworkLoopInterval) clearInterval(fireworkLoopInterval);
            if (fireworkTimer) cancelAnimationFrame(fireworkTimer);
            fireworkLoopInterval = null;
            fireworkTimer = null;
            fwCtx.clearRect(0, 0, fwCanvas.width, fwCanvas.height);
            fireworks = [];
            particles = [];
        }
    </script>
</body>
</html>
